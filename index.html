const supabaseUrl = 'https://tqhtggusphhcsygiitrv.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxaHRnZ3VzcGhoY3N5Z2lpdHJ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNDMxMTMsImV4cCI6MjA4NjYxOTExM30.HXA2GbucJPkt3LFl9_JpLiwUQvI95QNEDeQWzQ9i-pc';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

let inventory = [];

async function loadInventory() {
    const { data, error } = await supabase.from('items').select('*');
    if (error) return console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", error);
    
    inventory = data.map(item => ({
        name: item.product_name,
        location: `${item.drawer_no}ë²ˆ ì„œë [${item.position}]`, // ìƒì„¸ ìœ„ì¹˜ ë°˜ì˜
        link: `drawer.html?id=${item.drawer_no}`
    }));
}

function handleSearch() {
    const query = document.getElementById('searchInput').value;
    const resultList = document.getElementById('resultList');
    resultList.innerHTML = '';

    if (query.length >= 2) { // 2ì ì´ìƒ ë¡œì§
        const filtered = inventory.filter(item => item.name.includes(query));
        filtered.forEach(item => {
            resultList.innerHTML += `
                <div class="result-item">
                    <span>ğŸ“¦ ${item.name} â†’ <strong>${item.location}</strong></span>
                    <button onclick="location.href='${item.link}'">ìƒì„¸ë³´ê¸°</button>
                </div>`;
        });
    }
}
loadInventory();
