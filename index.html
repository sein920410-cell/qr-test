<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" /><title>ì‹œì œí’ˆ ê´€ë¦¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f9; }
    .card { background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    #edit-box { margin-top: 20px; padding: 20px; border: 2px solid #2e7d32; border-radius: 15px; background: #e8f5e9; }
    input, textarea { width: 100%; margin: 10px 0; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
    button { width: 100%; padding: 12px; background: #2e7d32; color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; }
  </style>
</head>
<body>
  <div class="card"><h2 id="title">ë¡œë”© ì¤‘...</h2><div id="items-list" style="white-space: pre-wrap;">...</div></div>
  <div id="edit-box">
    <p>ğŸ› ï¸ <strong>ê´€ë¦¬ì ëª¨ë“œ:</strong> ì¦‰ì‹œ ìˆ˜ì • ê°€ëŠ¥</p>
    <input type="text" id="new-name" placeholder="ì´ë¦„ ìˆ˜ì •">
    <textarea id="new-items" rows="4" placeholder="ë¬¼í’ˆ ìˆ˜ì • (ì‰¼í‘œë¡œ êµ¬ë¶„)"></textarea>
    <button id="update-btn">ì •ë³´ ì—…ë°ì´íŠ¸ (ì €ì¥)</button>
  </div>
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm"
    // ì¤‘ìš”: ì•„ë˜ í‚¤ë¥¼ ì‚¬ìš©ìë‹˜ì˜ ì§„ì§œ í‚¤ë¡œ ê¼­ ë°”ê¾¸ì„¸ìš”!
    const supabase = createClient("https://tqhtggusphhcsygiitrv.supabase.co", "https://tqhtggusphhcsygiitrv.supabase.co/auth/v1/verify?token=b14991b6f659e4f4b4189d17d9ae9993f690c7985fd81e25fe403626&type=magiclink&redirect_to=https://qr-test-sage.vercel.app/")
    let tagId = new URLSearchParams(window.location.search).get("tag") || "MAIN0001";

    document.getElementById("update-btn").onclick = async () => {
      const { error } = await supabase.from("tags").update({ 
        display_name: document.getElementById("new-name").value,
        items: document.getElementById("new-items").value 
      }).eq("id", tagId);
      if (error) alert("ì‹¤íŒ¨: " + error.message);
      else { alert("ì €ì¥ ì„±ê³µ!"); location.reload(); }
    };

    async function init() {
      const { data: tag } = await supabase.from("tags").select("*").eq("id", tagId).single();
      if (tag) {
        document.getElementById("title").innerText = tag.display_name;
        document.getElementById("items-list").innerText = tag.items || "ë¬¼í’ˆ ì—†ìŒ";
        document.getElementById("new-name").value = tag.display_name;
        document.getElementById("new-items").value = tag.items || "";
      }
    }
    init();
  </script>
</body>
</html>
