<script>
    // 1. ì‚¬ìš©ìë‹˜ì˜ ì‹¤ì œ ë°ì´í„° (ì„œë²„ ì—°ê²° ì‹¤íŒ¨ ì‹œ ë°±ì—…ìš©) [cite: 2026-02-15]
    const backupData = [
        { name: "ì«€ë””ê¸°", loc: "ì„œë 1ë²ˆ", id: 1 },
        { name: "í•«íŒ©", loc: "ì„œë 1ë²ˆ", id: 1 },
        { name: "ìˆ˜ì¤‘ì§‘ì–´ë“±", loc: "ì„œë 1ë²ˆ", id: 1 },
        { name: "ë² ë² ì•™ ë¬¼í‹°ìŠˆ", loc: "ì„œë 2ë²ˆ [ìƒë‹¨]", id: 2 },
        { name: "ì—¬ì„±ì²­ê²°ì œ", loc: "ì„œë 2ë²ˆ [2ë‹¨]", id: 2 },
        { name: "ë ¤ íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸", loc: "ì„œë 2ë²ˆ [2ë‹¨]", id: 2 },
        { name: "ì†Œí™”ê¸°", loc: "ì„œë 2ë²ˆ [í•˜ë‹¨]", id: 2 },
        { name: "ìš°ì‚°", loc: "ì„œë 2ë²ˆ [í•˜ë‹¨]", id: 2 }
    ];

    async function handleSearch() {
        const query = document.getElementById('searchInput').value;
        const resultList = document.getElementById('resultList');
        resultList.innerHTML = '';

        if (query.length < 2) return; // 2ì ë¯¸ë§Œì€ ë¬´ì‹œ [cite: 2026-02-16]

        try {
            // ìˆ˜íŒŒë² ì´ìŠ¤ ì‹œë„ [cite: 2026-02-15]
            const { data, error } = await supabase.from('items').select('*').ilike('product_name', `%${query}%`);
            
            if (error || !data || data.length === 0) throw new Error(); 

            data.forEach(item => {
                renderItem(item.product_name, `${item.drawer_no}ë²ˆ ì„œë [${item.position}]`, item.drawer_no);
            });
        } catch (e) {
            // ì„œë²„ ì‹¤íŒ¨ ì‹œ ë°±ì—… ë°ì´í„°ì—ì„œ ê²€ìƒ‰ (Standard Mode) [cite: 2026-02-16]
            const filtered = backupData.filter(item => item.name.includes(query));
            filtered.forEach(item => renderItem(item.name, item.loc, item.id));
        }
    }

    function renderItem(name, loc, id) {
        document.getElementById('resultList').innerHTML += `
            <div class="result-item">
                <span>ğŸ“¦ ${name} â†’ <strong>${loc}</strong></span>
                <button onclick="location.href='drawer.html?id=${id}'">ìƒì„¸ë³´ê¸°</button>
            </div>`;
    }
</script>
