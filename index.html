<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm"

const supabaseUrl = "https://tqhtggusphhcsygiitrv.supabase.co"
const supabaseKey = "sb_publishable_D9nhmN5ZlyApSrHHasyQ3w_O7Kdmssq
"
const supabase = createClient(supabaseUrl, supabaseKey)

const params = new URLSearchParams(window.location.search)
const tagId = params.get("tag")

const titleEl = document.getElementById("title")

if (!tagId) {
  titleEl.innerText = "태그 없음"
} else {
  try {
    const { data, error } = await supabase
      .from("tags")
      .select("display_name")
      .eq("id", tagId)

    if (error) {
      titleEl.innerText = "조회 에러"
      console.log(error)
      return
    }

    if (!data || data.length === 0) {
      titleEl.innerText = "없는 QR"
      return
    }

    titleEl.innerText = data[0].display_name
  } catch (e) {
    titleEl.innerText = "실행 오류"
    console.log(e)
  }
}
</script>
