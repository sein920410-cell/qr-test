// drawer.html의 <script> 부분에 덮어쓰세요
async function loadDrawerData() {
    const urlParams = new URLSearchParams(window.location.search);
    const drawerId = urlParams.get('id'); // QR 코드로 찍힌 ID

    const { data, error } = await supabase
        .from('tags')
        .select('*')
        .eq('id', drawerId)
        .single(); // 데이터 1개만 가져오기 [cite: 2026-02-15]

    if (data) {
        // 1. 미디어 노출 (media_url 사용) [cite: 2026-02-15]
        const mediaElement = document.getElementById('drawerMedia'); // img나 video 태그
        if (data.media_url) {
            // 주소에 mp4가 포함되면 비디오, 아니면 이미지로 판단
            if (data.media_url.includes('mp4')) {
                mediaElement.innerHTML = `<video src="${data.media_url}" controls width="100%"></video>`;
            } else {
                mediaElement.innerHTML = `<img src="${data.media_url}" width="100%">`;
            }
        }

        // 2. 체크리스트 (items 텍스트를 쉼표로 분리) [cite: 2026-01-11, 2026-02-16]
        const list = document.getElementById('checklist');
        const itemArray = data.items ? data.items.split(',') : ['등록된 물건이 없습니다'];
        list.innerHTML = itemArray.map(item => `
            <li><input type="checkbox"> ${item.trim()}</li>
        `).join('');

        document.getElementById('drawerTitle').innerText = data.display_name;
    }
} 
loadDrawerData();
